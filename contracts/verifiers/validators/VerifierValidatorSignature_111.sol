// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.0;
import "../../libs/Paring.sol";

contract VerifierValidatorSignature_111 {
    using Pairing for *;
    struct VerifyingKey {
        Pairing.G1Point alfa1;
        Pairing.G2Point beta2;
        Pairing.G2Point gamma2;
        Pairing.G2Point delta2;
        Pairing.G1Point[] IC;
    }
    struct Proof {
        Pairing.G1Point A;
        Pairing.G2Point B;
        Pairing.G1Point C;
    }
    function verifyingKey() internal pure returns (VerifyingKey memory vk) {
        vk.alfa1 = Pairing.G1Point(
            20491192805390485299153009773594534940189261866228447918068658471970481763042,
            9383485363053290200918347156157836566562967994039712273449902621266178545958
        );

        vk.beta2 = Pairing.G2Point(
            [4252822878758300859123897981450591353533073413197771768651442665752259397132,
             6375614351688725206403948262868962793625744043794305715222011528459656738731],
            [21847035105528745403288232691147584728191162732299865338377159692350059136679,
             10505242626370262277552901082094356697409835680220590971873171140371331206856]
        );
        vk.gamma2 = Pairing.G2Point(
            [11559732032986387107991004021392285783925812861821192530917403151452391805634,
             10857046999023057135944570762232829481370756359578518086990519993285655852781],
            [4082367875863433681332203403145435568316851327593401208105741076214120093531,
             8495653923123431417604973247489272438418190587263600148770280649306958101930]
        );
        vk.delta2 = Pairing.G2Point(
            [11559732032986387107991004021392285783925812861821192530917403151452391805634,
             10857046999023057135944570762232829481370756359578518086990519993285655852781],
            [4082367875863433681332203403145435568316851327593401208105741076214120093531,
             8495653923123431417604973247489272438418190587263600148770280649306958101930]
        );
        vk.IC = new Pairing.G1Point[](67);
        
        vk.IC[0] = Pairing.G1Point( 
            16317808168961945832037519470481723547491128415360175732708760238633782558631,
            13140237536424385958744830435096387978579252876891548870459178996313779644320
        );                                      
        
        vk.IC[1] = Pairing.G1Point( 
            17453205190159884425019607427770552751288280224894116796216567486862571359468,
            681950185989909035806376779892015629401905516543725109841289860666945230222
        );                                      
        
        vk.IC[2] = Pairing.G1Point( 
            9709090226594378952573922337899208194609768514747026303591532283128951829612,
            20849632257157779009706598722153960887659070668245324544167890397439020762131
        );                                      
        
        vk.IC[3] = Pairing.G1Point( 
            16156640214363377062617333744526010366347940014629731693204472563110697460226,
            778858663698048376649969715751241439437452457010534776842330493754860701502
        );                                      
        
        vk.IC[4] = Pairing.G1Point( 
            14760780728537243343535465076685771394025253087191569053836144269101992140219,
            11901813975872407430179927323517867507032698858100712513673651525367895644659
        );                                      
        
        vk.IC[5] = Pairing.G1Point( 
            9104180250343774843596392105494606955655081666624640057865046244472123119144,
            5654457518597182743535213004897493705905007018241767868955570263287580711980
        );                                      
        
        vk.IC[6] = Pairing.G1Point( 
            5623550707240339257179459931074953759590413679236932076990476149210277590218,
            14344107518522912533046084215426753923479803326094978240507779954867659504457
        );                                      
        
        vk.IC[7] = Pairing.G1Point( 
            8767226135852225843661510222631374578023836582256942563074932915267983743176,
            17855387790331212409826111650889154310205339062320412893748295501252291070019
        );                                      
        
        vk.IC[8] = Pairing.G1Point( 
            9438980404698207701977770613159520864693750182822345602163711842312296524044,
            17789711452243066205712462940057058190396334348056306007422712951922777475095
        );                                      
        
        vk.IC[9] = Pairing.G1Point( 
            4581752027790590305547890938267536449325939949750834527486953509774765475275,
            4811678210055698134032092785482703581973835079424453881810946426797375676777
        );                                      
        
        vk.IC[10] = Pairing.G1Point( 
            17338575125553141435700084894110071088967141326969267347348505003885563045638,
            11573418055638133527258777072912671168161967512611549189991146524946485367224
        );                                      
        
        vk.IC[11] = Pairing.G1Point( 
            2432165675152466667889179101977665991563852100354072058035892269804989977799,
            12245381377382466952896426311099030472934417971526110111551683641676448913044
        );                                      
        
        vk.IC[12] = Pairing.G1Point( 
            4172399033190676694113926583214625282227921932972929264680920728072192666987,
            10060110690712493309293435999282255067690914882839416198746156193472313791224
        );                                      
        
        vk.IC[13] = Pairing.G1Point( 
            19171120331879055654869202329506160241787113586234536542571235015409728765076,
            8188791513791059535838988959763392952664609947648380567371287989924775312852
        );                                      
        
        vk.IC[14] = Pairing.G1Point( 
            1316481804315022308477959603479131518418334403035055633392107725724944145528,
            4999957328115127800431604041424689761126397260024589471823687527589461393621
        );                                      
        
        vk.IC[15] = Pairing.G1Point( 
            6822418152396416697980146337095541727758735853311788685558253181583476695766,
            3988083287751037305664195495136722452592893232001157493706142563553972269210
        );                                      
        
        vk.IC[16] = Pairing.G1Point( 
            10949626278154834577287411461358018221712954056737110487089332828234636578779,
            5039389526958779225921093929656498151293688604204708412308617181776958419265
        );                                      
        
        vk.IC[17] = Pairing.G1Point( 
            15507539607723958524072615343444896267500471582289576828285372046835164339848,
            2435491445224857455695657690164770686562860815216071657276094586946485336272
        );                                      
        
        vk.IC[18] = Pairing.G1Point( 
            4499432267842233180201588605469037007166217508233293295296757013466684694490,
            13098153772858124001350017950075525836365701840507482901157546143031640377792
        );                                      
        
        vk.IC[19] = Pairing.G1Point( 
            3939570910551670108621719608707251309006223272339433092459876420881601502059,
            13168746523851693985349364893458607625522713958252154840599612145882282975692
        );                                      
        
        vk.IC[20] = Pairing.G1Point( 
            15382887110439618993797123320323707434051176267223829484989705420151350773644,
            19292714186755438580190188341654965909449766673971512229802330969127426063190
        );                                      
        
        vk.IC[21] = Pairing.G1Point( 
            3814745282342960032316821027511497794710414784243468347919226736968650183586,
            20251202789308037183319059101240772135209269629737281769249456260641439145865
        );                                      
        
        vk.IC[22] = Pairing.G1Point( 
            4484382387501217954449913494920142139708095169158790543211284689199734166635,
            11799361915297056626860774905233917512141320945582251542880293399230018542048
        );                                      
        
        vk.IC[23] = Pairing.G1Point( 
            5966555512024800718598036409120752181745708225783930657719497891026900266718,
            13942758115129667856400993503175342317286487742785303057081045806481346114358
        );                                      
        
        vk.IC[24] = Pairing.G1Point( 
            603053896779771822082216062539570273096610279183638018602367243339673285421,
            8876840584479268821078697545149645524115435781369070107749337942424410917914
        );                                      
        
        vk.IC[25] = Pairing.G1Point( 
            11311757525554035226904427788185610128294577761943430493227137915197691776952,
            21696907333597904524150031010747455564673934275160403236872697054686024442534
        );                                      
        
        vk.IC[26] = Pairing.G1Point( 
            10431751162446741606372141806431380775629091422639029620337582533089628934171,
            9403274679151616669225172239411079333348104778651942062826065691301497155888
        );                                      
        
        vk.IC[27] = Pairing.G1Point( 
            14206169820072321209221568781615296714465555103159193400374133003105487075353,
            3586986957494511723946911470849187847097452211986559930514202045756839340809
        );                                      
        
        vk.IC[28] = Pairing.G1Point( 
            1374308860606908379081441893454724878070594087439633912318973693071817927978,
            21685033862338357647759417910246581835750855281247803045309197533901723016360
        );                                      
        
        vk.IC[29] = Pairing.G1Point( 
            16570743433723176876372164631526338297225759790525798623131543066798275015600,
            6636998001067423666501719746241923126226465401995244328335062006312298762205
        );                                      
        
        vk.IC[30] = Pairing.G1Point( 
            3447748512742635648672251373575044108330594967336644090800116680673504266471,
            21415407787377515215494339602661976659057941775265770999108467054264257436878
        );                                      
        
        vk.IC[31] = Pairing.G1Point( 
            4821416949316892018581142111005806814353919907466073597371931104492228576384,
            19480707290506733501872098603355483964964762295145248730858092322396823703651
        );                                      
        
        vk.IC[32] = Pairing.G1Point( 
            21271033818356808085003944377119908043615540821860274156249605170915080966928,
            20917768397446073011426569302840141020381455564279425915448418331658727697595
        );                                      
        
        vk.IC[33] = Pairing.G1Point( 
            13693425532250986670896229490751893021646847364806742550032463988688242233688,
            12294067302635248452032888422449653830347743449187730594800969022988857465701
        );                                      
        
        vk.IC[34] = Pairing.G1Point( 
            5483305560889056264683768222989689071365232358905616071121407866621408534216,
            10121153581719238193781587793049357994085078536937267735052342540437281105663
        );                                      
        
        vk.IC[35] = Pairing.G1Point( 
            4281476958145648785284696112181502121046162451629705591347334700787916784119,
            9292876556734750090547454842497672858972431149109259267668226913554817553515
        );                                      
        
        vk.IC[36] = Pairing.G1Point( 
            10251976081809695301277653463033912579497020186582717755069980792057592340947,
            11198567894052593231604527716070339919559008256505728237524777757081282129007
        );                                      
        
        vk.IC[37] = Pairing.G1Point( 
            4017547717596421252614301835031003539857094990114659796965854359010995729751,
            17908902522477381716952245684525690051277470944864546037349181440800478676473
        );                                      
        
        vk.IC[38] = Pairing.G1Point( 
            16944693292932466796277980096264196241520376893027473406352877253626884802903,
            15028588802133104931808296646565746908184751181370256510265266131309064836790
        );                                      
        
        vk.IC[39] = Pairing.G1Point( 
            20169105304135423420284278581406306187047520388954424137098719208795738462100,
            18911401391925170659403571256066982090531073472928490424057366711362611913675
        );                                      
        
        vk.IC[40] = Pairing.G1Point( 
            20454667968751364812931920269630798592659617668063488269439879346361956994462,
            5209831768250027335293694517878318083266081276527574242910991824585102424143
        );                                      
        
        vk.IC[41] = Pairing.G1Point( 
            7502519534936289075883176982406402250001115296832190219897905423709033874539,
            9192308562099859246743855226004997391611274296736254176857974260457655699783
        );                                      
        
        vk.IC[42] = Pairing.G1Point( 
            12598293767086939276739458373267936495316716184074040599019809062590404111165,
            19897982923616460177980531754925218536076316208990971746936746408339774823434
        );                                      
        
        vk.IC[43] = Pairing.G1Point( 
            10181037940078605608475539940809267869354500759942301941574764632960517607114,
            18940433380266582940555845929635716261408737516507778719359650347680637741456
        );                                      
        
        vk.IC[44] = Pairing.G1Point( 
            16698603633479381787482237519728377437748338227828281982137302751115571071177,
            18023367040734134985516060880191655123698473168837646799596261037211984795056
        );                                      
        
        vk.IC[45] = Pairing.G1Point( 
            15577780114648629764988370582686257499670657002501151930667006074510864218109,
            19620479352348176120478541432804370740099857626915242092260365234330015674172
        );                                      
        
        vk.IC[46] = Pairing.G1Point( 
            6444757117689321532042430480621739149137910600434616345374634737996284406702,
            2777650531007658483993365834571571167886294599626677072136146199654186713443
        );                                      
        
        vk.IC[47] = Pairing.G1Point( 
            8209392102201605017353699165144439543880905452113602062483201960984868409238,
            18544750931542693608518197084557642339072092957381555672958778334080102629749
        );                                      
        
        vk.IC[48] = Pairing.G1Point( 
            9911053725763964231893978564418896032623451453013919936831761093784511443515,
            20467290472170140217401682068670379624595288710621262511282385097338008293444
        );                                      
        
        vk.IC[49] = Pairing.G1Point( 
            19624055371025257209219739498163219074178145429134623116321691584647066489871,
            11136017841428964355177390919271612390477109354861881662355194181834672379783
        );                                      
        
        vk.IC[50] = Pairing.G1Point( 
            6393423065138659495653528255972387731935297903446099070397168889989290200507,
            19226583594313976367937389145763732079343764618888916906508087534569872321992
        );                                      
        
        vk.IC[51] = Pairing.G1Point( 
            4626969400835024920345279106930533250124709543247110583333192381272234254943,
            3373822434420144637183478183442964768105307908866790509166256072455034014093
        );                                      
        
        vk.IC[52] = Pairing.G1Point( 
            6508158819738472565290998748558426016822437266915052528744197500914352892831,
            17504328960567957703343957894289734066028510262001395825254282137667319175278
        );                                      
        
        vk.IC[53] = Pairing.G1Point( 
            880134606965538278499171110503594692712755037268184905101487357849161184003,
            5624803071804024626704866235943090146711261121232927264256343064614131698609
        );                                      
        
        vk.IC[54] = Pairing.G1Point( 
            3577435521716677877031145560142237366002998241702755938213124582441860564796,
            17637840175778899681740342519433269211549274864964993196846026320728486798167
        );                                      
        
        vk.IC[55] = Pairing.G1Point( 
            10964300483401675336352246261267005321705283165583197234540217424682307550469,
            17101595696082422800033621601455574650173078350133431072537562127570929737537
        );                                      
        
        vk.IC[56] = Pairing.G1Point( 
            4053672088670504243473922800705298214208881000289159222415123875544292930988,
            7846583989142405402933426996323957628239303282038356986529107503364559200414
        );                                      
        
        vk.IC[57] = Pairing.G1Point( 
            13026264558728523502016181516668543763697848130661515911608432491586429795320,
            14342639421752291034481339344440628696437406646817266622283737443392838029837
        );                                      
        
        vk.IC[58] = Pairing.G1Point( 
            17759042310633887780954832732626373687515254405067005157330393096427974303824,
            99432472712521366504960529020870539888554210342186357910703832331806271885
        );                                      
        
        vk.IC[59] = Pairing.G1Point( 
            13276172302967852607205671411384967161672840275829723172956276188397038242823,
            1372175904153366819251784321348254360871468411514503329135328680017839877291
        );                                      
        
        vk.IC[60] = Pairing.G1Point( 
            14551952178785409917186577788752073330378774348131565393626012850009050078790,
            5686827122350586041341105301313378781100190213325382296487175176126120742219
        );                                      
        
        vk.IC[61] = Pairing.G1Point( 
            15280540673320655127155130660277704217415023395273969984298573071498203950116,
            10308271917047144409372008632576582747150307297702338066330386379051872499481
        );                                      
        
        vk.IC[62] = Pairing.G1Point( 
            13687242296818325899298751502789313686522813286447376071767013934347504943484,
            18715770558648819072012034439332502001067512957088842339797916463396002557076
        );                                      
        
        vk.IC[63] = Pairing.G1Point( 
            17001216689685612120293213769123499114027284308248001356980873431763562672278,
            19659715877969703145652573564990163113043222717886967502895946208968604748826
        );                                      
        
        vk.IC[64] = Pairing.G1Point( 
            15500692356396230002662252419496163820835439193398580945503047702571913597404,
            4837385477678101549475888910670643848559484670503557820533725469453019541202
        );                                      
        
        vk.IC[65] = Pairing.G1Point( 
            8194414883177815045786998179774010279369299405357105905948068280399718152682,
            15575872253967858788067894029513152579973197683865450480173748163537752937572
        );                                      
        
        vk.IC[66] = Pairing.G1Point( 
            20995743955317202856419752073640118786551564261996529882329973547109606967737,
            1110250599879603567011435196645767617486025440605361939877084973434561372876
        );                                      
        
    }
    function verify(uint[] memory input, Proof memory proof) internal view returns (uint) {
        uint256 snark_scalar_field = 21888242871839275222246405745257275088548364400416034343698204186575808495617;
        VerifyingKey memory vk = verifyingKey();
        require(input.length + 1 == vk.IC.length,"verifier-bad-input");
        // Compute the linear combination vk_x
        Pairing.G1Point memory vk_x = Pairing.G1Point(0, 0);
        for (uint i = 0; i < input.length; i++) {
            require(input[i] < snark_scalar_field,"verifier-gte-snark-scalar-field");
            vk_x = Pairing.addition(vk_x, Pairing.scalar_mul(vk.IC[i + 1], input[i]));
        }
        vk_x = Pairing.addition(vk_x, vk.IC[0]);
        if (!Pairing.pairingProd4(
            Pairing.negate(proof.A), proof.B,
            vk.alfa1, vk.beta2,
            vk_x, vk.gamma2,
            proof.C, vk.delta2
        )) return 1;
        return 0;
    }
    /// @return r  bool true if proof is valid
    function verifyProof(
            uint[2] memory a,
            uint[2][2] memory b,
            uint[2] memory c,
            uint[] memory input
        ) public view returns (bool r) {
        Proof memory proof;
        proof.A = Pairing.G1Point(a[0], a[1]);
        proof.B = Pairing.G2Point([b[0][0], b[0][1]], [b[1][0], b[1][1]]);
        proof.C = Pairing.G1Point(c[0], c[1]);
        uint[] memory inputValues = new uint[](input.length);
        for(uint i = 0; i < input.length; i++){
            inputValues[i] = input[i];
        }
        if (verify(inputValues, proof) == 0) {
            return true;
        } else {
            return false;
        }
    }
}
